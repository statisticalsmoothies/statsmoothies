<!DOCTYPE html>
<html lang="en"><head>
<script src="Presentation Salerno_files/libs/clipboard/clipboard.min.js"></script>
<script src="Presentation Salerno_files/libs/quarto-html/tabby.min.js"></script>
<script src="Presentation Salerno_files/libs/quarto-html/popper.min.js"></script>
<script src="Presentation Salerno_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Presentation Salerno_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Presentation Salerno_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Presentation Salerno_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Presentation Salerno_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.433">

  <meta name="author" content="Giacomo Biganzoli">
  <meta name="author" content="Giuseppe Marano">
  <meta name="author" content="Joel Schwartz">
  <meta name="author" content="Patrizia Boracchi">
  <title>Semi-parametric estimation of conditional distributions for multivariate health outcomes</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Presentation Salerno_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Presentation Salerno_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="Presentation Salerno_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="custom-styles.css">
  <link href="Presentation Salerno_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Presentation Salerno_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Presentation Salerno_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Presentation Salerno_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Semi-parametric estimation of conditional distributions for multivariate health outcomes</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Giacomo Biganzoli 
</div>
        <p class="quarto-title-affiliation">
            Department of Clinical and Biomedical Sciences, Univeristy of Milan
          </p>
        <p class="quarto-title-affiliation">
            Department of Environmental Health, Harvard T.H. Chan School of Public Health
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Giuseppe Marano 
</div>
        <p class="quarto-title-affiliation">
            Department of Clinical and Biomedical Sciences, Univeristy of Milan
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Joel Schwartz 
</div>
        <p class="quarto-title-affiliation">
            Department of Environmental Health, Harvard T.H. Chan School of Public Health
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Patrizia Boracchi 
</div>
        <p class="quarto-title-affiliation">
            Department of Clinical and Biomedical Sciences, Univeristy of Milan
          </p>
    </div>
</div>

</section>
<section id="presentation-in-bites" class="slide level2 my-callout">
<h2>Presentation in bites 🍪</h2>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<ul>
<li><p>Continuous outcomes are <strong>informative</strong> but often difficult to model with classical parametric models.</p></li>
<li><p>Sometimes health outcomes are multi-factorial and the interest lies in assessing the influence of exposure on their joint distribution</p></li>
<li><p>The probability density and the cumulative distribution functions fully describe a continuous outcome.</p></li>
<li><p><strong>Flexible models</strong> that directly obtain smoothed estimates of the CDF or—indirectly—of the PDF, conditional on covariate X, exist. We can easily obtain estimates of the joint PDF and CDF with the chain rule of probability.</p></li>
<li><p>We need to translate complex model outputs into <strong>interpretable</strong> statements about <strong>probability mass shifts</strong> associated to X, with intervals that describe the most typical values of the conditional distribution.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="traditional-approach" class="slide level2">
<h2>1. Traditional Approach</h2>
<p>Physical Activity (PA) (METs) <strong>Exposure</strong> and Metabolic Health <strong>(Multi-factorial) Outcome</strong>.</p>
<ul>
<li><strong>Traditional Method</strong>: Model the presence/absence of Metabolic Syndrome (MSy) using logistic regression.
<ul>
<li><code>log(odds of MSy) = β₀ + β₁ * METs</code></li>
</ul></li>
<li><strong>Limitations of this approach</strong> (<span class="citation" data-cites="beckstead2010">Beckstead and Beckie (<a href="#/references" role="doc-biblioref" onclick="">2010</a>)</span>) :</li>
</ul>
<div class="columns">
<div class="column" style="width:70%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="met_inf.png" style="width:100.0%"></p>
<figcaption>not much (98% of information lost)</figcaption>
</figure>
</div>
</div><div class="column" style="width:30%;">
<ul>
<li>PCA?</li>
<li>Multivariate models?</li>
</ul>
</div>
</div>
</section>
<section id="beyond-binary-modeling-representative-continuous-outcomes-variables-univariable" class="slide level2">
<h2>2. Beyond Binary: modeling representative continuous outcomes variables (univariable)</h2>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li><strong>Common Method</strong>: Use Ordinary Least Squares (OLS) or Generalized Linear Models (GLM) to model the <strong>expected value (mean)</strong> of the outcome: <code>E[Glucose | METs] = β₀ + β₁ * METs</code></li>
<li><strong>Limitation</strong>: focused on the <em>average</em> response. What about the entire shape of the outcome’s distribution? -&gt; Probability density function obtained with <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\epsilon\)</span> but <strong>Rigid assumptions</strong> about the distribution of the outcome conditional on the exposure.</li>
</ul>
</div><div class="column" style="width:70%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figure0.png"></p>
<figcaption>Modeling the expected value of Plasma Glucose as a function of PA (METs)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="example-the-relationship-between-glu-and-tgy-and-levels-of-physical-activity-mets" class="slide level2">
<h2>3. Example: the relationship between glu and tgy and Levels of Physical Activity (METs)</h2>

<img data-src="figure1.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">The effect of PA is visualized as a shift in the probability mass described by the change in the location and the scale of the PDF of Plasma glucose and Triglycerides</p></section>
<section id="moving-beyond-location-and-the-rigid-assumptions-of-ols" class="slide level2">
<h2>4. Moving beyond location and the rigid assumptions of OLS</h2>
<p>How does the increment of Physical Activity levels change the distribution of glucose and triglycerides?</p>
<ul>
<li><p><strong>Probability Density Function (PDF)</strong></p></li>
<li><p><strong>Cumulative Distribution Function (CDF)</strong></p></li>
<li><p><strong>The Challenge</strong>: How do we estimate the <em>conditional PDF and CDF</em> (the PDF/CDF of the outcome for a given exposure level)?</p></li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li><p><strong>Quantile Regression</strong>: Models specific percentiles (e.g., the 25th, 50th, 75th) of the outcome.</p></li>
<li><p><strong>Parametric methods</strong> assume a fixed distribution (e.g., Normal, log-normal, exponential), which often doesn’t hold, even with their extensions (GAMLSS).</p></li>
<li><p><strong>Non-parametric methods</strong> (like Kernel Density Estimation) are flexible but struggle with multiple covariates and limited data.</p></li>
</ul>
</div>
</div>
</div>
<div style="border: 2px solid black; padding: 15px; background-color: #A3C8C3; font-size: 30px">
  <strong>Flexible models</strong> on the (discrete) hazard function (1) and the cumulative distribution function of the outcome (2). We adopt <strong>splines</strong>
</div>
<p><span class="citation" data-cites="laird1981 andersen2003">(<a href="#/references" role="doc-biblioref" onclick="">Laird and Olivier 1981</a>; <a href="#/references" role="doc-biblioref" onclick="">Andersen 2003</a>)</span></p>
</section>
<section id="how-flexible-the-models-are" class="slide level2">
<h2>5. How flexible the models are</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><span class="math inline">\(\scriptsize \log[\lambda(y|X)] = \beta X + \sum_{k=1}^{K} (\gamma_k + \delta_k X) B_k(y)\)</span></p>
<p><span class="math inline">\(\scriptsize F(y|X) = \beta X + \sum_{k=1}^{K} (\gamma_k + \delta_k X) B_k(y)\)</span></p>
<p><span class="math inline">\(\scriptsize ^*\widehat{f}(y) = \widehat{\lambda}(y)exp\bigl[-\widehat{\Lambda}(y)\bigl]\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="wikipedia.png" style="width:100.0%"></p>
<figcaption><a href="https://en.wikipedia.org/wiki/Density_estimation">Wikipedia: Density estimation</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="wikipima.png" style="width:90.0%"></p>
<figcaption>Estimates of the PDF and the CDF derived from the PWE model (top panels) and the transformation model on pseudo-observations (bottom panels)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretable-statements-about-the-outcome-hyndman1996-scriptsize-r_alpha-y-in--infty-infty-fy-ge-k_alpha-textsuch-that-quad-int_r_alpha-fydu-alpha" class="slide level2">
<h2>6. Interpretable statements about the outcome <span class="citation" data-cites="hyndman1996">(<a href="#/references" role="doc-biblioref" onclick="">Hyndman 1996</a>)</span> <span class="math inline">\(\scriptsize R_{\alpha} = \{y \in [-\infty, \infty] : f(y) \ge k'_{\alpha}\}\, \text{such that} \quad \int_{R_{\alpha}} f(y)du = \alpha\)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="interval_comp.png" style="width:70.0%"></p>
<figcaption>Some probability intervals to summarize a distribution from the PDF</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="interval_comp2.png" style="width:70.0%"></p>
<figcaption>Some probability intervals to summarize a distribution from the CDF</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="translate-model-outputs-into-interpretable-statements-about-the-outcome-1d-hdrs" class="slide level2">
<h2>7. Translate model outputs into interpretable statements about the outcome: 1D HDRs</h2>

<img data-src="figure3.png" class="r-stretch quarto-figure-center"><p class="caption">HDR intervals of Plasma Glucose (left) and Plasma Triglycerides (right) conditional levels of PA (METs) for diffenret probability levels</p></section>
<section id="what-about-the-effect-of-pa-on-the-joint-distribution-of-glucose-triglycerides" class="slide level2">
<h2>8. What about the effect of PA on the joint distribution of Glucose &amp; Triglycerides</h2>

<img data-src="figure2.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">The effect of PA is visualized as a shift in the probability mass defined by the joint PDF of Plasma glucose and Triglycerides</p></section>
<section id="hdr-for-the-joint-distribution-of-glucose-triglycerides" class="slide level2">
<h2>8. HDR for the joint distribution of Glucose &amp; Triglycerides</h2>

<img data-src="figure4.png" class="r-stretch quarto-figure-center"><p class="caption">Joint HDR intervals of Plasma Glucose (left) and Plasma Triglycerides (right) conditional levels of PA (METs) for different probability levels</p></section>
<section id="simulation-study" class="slide level2">
<h2>9. Simulation Study</h2>
<div class="columns">
<div class="column smaller" style="width:40%;">
<p><strong>Data Generating Process:</strong></p>
<p><code>M = 1000, N = 1000</code></p>
<ul>
<li><p><span class="math inline">\(\scriptsize \text{METs} \sim \text{Log-Normal}(\mu = 2, \sigma = 0.4 )\)</span></p></li>
<li><p><span class="math inline">\(\scriptsize \text{glu} \mid \text{METs} \sim \text{Log-Normal}(\mu = \beta_0 - 0.04 \cdot \text{METs}, \sigma = 0.2)\)</span></p></li>
<li><p><span class="math inline">\(\scriptsize \text{tgy} \mid \text{METs} \sim \text{Log-Normal}(\mu = \beta_0 - 0.1 \cdot \text{METs}, \sigma = 0.3 )\)</span></p></li>
</ul>
</div><div class="column smaller" style="width:30%;">
<p><strong>Estimands:</strong></p>
<p><span class="math inline">\(F(\text{glu}|\text{METs}),\ F(\text{tgy}|\text{METs})\)</span>;<br>
</p>
<p><span class="math inline">\(f(\text{glu}|\text{METs}),\ f(\text{tgy}|\text{METs})\)</span>;<br>
</p>
<p>and <span class="math inline">\(f(\text{glu, tgy}|\text{METs})\)</span><br>
</p>
<p><strong>(25%,50%, 75%, 90%) HDRs</strong> (1D, 2D)<br>
</p>
</div><div class="column smaller" style="width:30%;">
<p><strong>Performance:</strong></p>
<p><strong>(mean) Jaccard index</strong> across <code>M</code></p>
<p><span class="math inline">\(J(\text{est}, \text{true}) = \frac{|\text{est} \cap \text{true}|}{|\text{est} \cup \text{true}|}\)</span><br>
</p>
<p><span class="math inline">\(J(\text{est}, \text{true}) = \frac{\text{Area}(\text{est} \cap \text{true})}{\text{Area}(\text{est} \cup \text{true})}\)</span></p>
</div>
</div>

<img data-src="fig_jac.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Jaccard indexes</p></section>
<section id="simulation-study-results-1d" class="slide level2">
<h2>9. Simulation Study: results (1D)</h2>

<img data-src="res1.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Mean Jaccard indexes for Glucose and Triglicerides conditional HDRs</p></section>
<section id="simulation-study-results-2d" class="slide level2">
<h2>9. Simulation Study: results (2D)</h2>

<img data-src="hdr_res_joint.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Mean Jaccard indexes for HDRs of the joint distribution of Plasma Glucose and Plasma Triglycerides conditional on METs</p></section>
<section id="conclusion-impact" class="slide level2">
<h2>10. Conclusion &amp; Impact</h2>
<p><strong>What does this new approach offer?</strong> 🚀</p>
<ul>
<li><strong>Goes Beyond Averages</strong>: It moves past simple location-based regression to capture the <strong>entire distributional shift</strong> of a health outcome in response to an exposure.</li>
<li><strong>Flexibility</strong>: The semi-parametric nature avoids rigid distributional assumptions.</li>
<li><strong>Interpretability</strong>: Stays within the well-understood GLM/GAM framework.</li>
<li><strong>Richer Insights</strong>: Provides a more complete and nuanced understanding of the dose-response relationship, which is vital for informing effective public health policy and evidence-based interventions.</li>
</ul>
<p><strong>Limits</strong></p>
<ul>
<li>More elaborate than simple OLS (other than possible non-linear effects of the exposure, we need to model the baseline CDF/hazard function + possible baseline-varying effects)</li>
<li>Sample size required is high (simulations indicate N &gt;500 to have reliable HDRs)</li>
<li>We don’t have an algorithm to compute 2D HDRs from joint CDF.</li>
<li>Hypothesis testing is less straightforward</li>
</ul>
</section>
<section id="thank-you" class="slide level2">
<h2>Thank you !</h2>

<img data-src="QR_code.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Follow me on Git-Hub or e-mail me giacomo.biganzoli@unimi.it</p></section>
<section id="application-pima-indian-dataset" class="slide level2">
<h2>Application: Pima Indian Dataset</h2>
<ul>
<li><strong>Dataset</strong>: The <strong>Pima Indian Diabetes Study</strong> <span class="citation" data-cites="keen1971">(<a href="#/references" role="doc-biblioref" onclick="">Keen and Jarett 1971</a>)</span>, a landmark study on type 2 diabetes risk factors.</li>
<li><strong>Analysis</strong>: Explore the impact of <strong>adiposity (Tricep skinfold)</strong> on the distributions of two key metabolic outcomes:
<ol type="1">
<li>Fasting Glucose</li>
<li>Blood Pressure</li>
</ol></li>
<li>This showcases how the method can uncover nuanced relationships in real, complex data.</li>
</ul>

<img data-src="PIMARTICLE.png" style="width:60.0%" class="r-stretch"></section>
<section id="application-pima-indian-dataset-1" class="slide level2">
<h2>Application: Pima Indian Dataset</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tf_glu.png" style="width:100.0%"></p>
<figcaption>Target functions (CDF and PDF) describing the distribution of Glucose, conditional of values of Tricep Skinfold Thickness of 10 mm and 50 mm</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tf_bp.png" style="width:100.0%"></p>
<figcaption>Target functions (CDF and PDF) describing the distribution of diastolic blood pressure, conditional of values of Tricep Skinfold Thickness of 10 mm and 50 mm</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="application-pima-indian-dataset-2" class="slide level2">
<h2>Application: Pima Indian Dataset</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="hdr_glu.png" style="width:100.0%"></p>
<figcaption>HDRs sumarizing the most typical value of the distribution of Glucose, conditional of values of Tricep Skinfold Thickness</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="hdr_bp.png" style="width:100.0%"></p>
<figcaption>HDRs sumarizing the most typical value of the the distribution of diastolic blood pressure, conditional of values of Tricep Skinfold Thickness</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="application-pima-indian-dataset-3" class="slide level2">
<h2>Application: Pima Indian Dataset</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="joint_pima.png" style="width:100.0%"></p>
<figcaption>Joint PDF of Blood Pressure (mmHg) and Plasma Glucose (mg/dL) conditional on values of Tricep Skinfold Thickness</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="joint_hdr_pima.png" style="width:100.0%"></p>
<figcaption>2D HDRs sumarizing the most typical values of the joint distribution of diastolic blood pressure and glucose, conditional of values of Tricep Skinfold Thickness</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="supplementary-overall-workflow" class="slide level2">
<h2>Supplementary: overall workflow</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 1178.00 554.40" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 550.4)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-550.4 1174,-550.4 1174,4 -4,4"></polygon> <g id="clust1" class="cluster">
<title>
cluster_challenge
</title>
<path fill="#f2eadf" stroke="black" d="M20,-452C20,-452 1150,-452 1150,-452 1156,-452 1162,-458 1162,-464 1162,-464 1162,-526.4 1162,-526.4 1162,-532.4 1156,-538.4 1150,-538.4 1150,-538.4 20,-538.4 20,-538.4 14,-538.4 8,-532.4 8,-526.4 8,-526.4 8,-464 8,-464 8,-458 14,-452 20,-452"></path> <text text-anchor="start" x="16" y="-515.6" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="22.00"> Pre-process the outcome variable Y </text> </g> <g id="clust2" class="cluster">
<title>
cluster_method
</title>
<path fill="#68a2a8" stroke="black" d="M173,-224C173,-224 1059,-224 1059,-224 1065,-224 1071,-230 1071,-236 1071,-236 1071,-418.4 1071,-418.4 1071,-424.4 1065,-430.4 1059,-430.4 1059,-430.4 173,-430.4 173,-430.4 167,-430.4 161,-424.4 161,-418.4 161,-418.4 161,-236 161,-236 161,-230 167,-224 173,-224"></path> <text text-anchor="start" x="169" y="-407.6" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="22.00">Flexible Modeling Engine (GLM/GAM Framework)</text> </g> <g id="clust3" class="cluster">
<title>
cluster_outputs
</title>
<path fill="#a3c8c3" stroke="black" d="M371,-8C371,-8 749,-8 749,-8 755,-8 761,-14 761,-20 761,-20 761,-190.4 761,-190.4 761,-196.4 755,-202.4 749,-202.4 749,-202.4 371,-202.4 371,-202.4 365,-202.4 359,-196.4 359,-190.4 359,-190.4 359,-20 359,-20 359,-14 365,-8 371,-8"></path> <text text-anchor="start" x="367" y="-179.6" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="22.00">Interpretable Outputs</text> </g> <!-- Challenge --> <g id="node1" class="node">
<title>
Challenge
</title>
<path fill="#ffffff" stroke="#b3d9ff" d="M556.37,-496C556.37,-496 27.63,-496 27.63,-496 21.63,-496 15.63,-490 15.63,-484 15.63,-484 15.63,-472 15.63,-472 15.63,-466 21.63,-460 27.63,-460 27.63,-460 556.37,-460 556.37,-460 562.37,-460 568.37,-466 568.37,-472 568.37,-472 568.37,-484 568.37,-484 568.37,-490 562.37,-496 556.37,-496"></path> <text text-anchor="middle" x="292" y="-472" font-family="Helvetica,sans-Serif" font-size="20.00">Discretize Y in intervals with width W to feed the PWE model</text> </g> <!-- Hazard_Model --> <g id="node4" class="node">
<title>
Hazard_Model
</title>
<path fill="#ffffff" stroke="#b3d9ff" d="M525.36,-388C525.36,-388 180.64,-388 180.64,-388 174.64,-388 168.64,-382 168.64,-376 168.64,-376 168.64,-352 168.64,-352 168.64,-346 174.64,-340 180.64,-340 180.64,-340 525.36,-340 525.36,-340 531.36,-340 537.36,-346 537.36,-352 537.36,-352 537.36,-376 537.36,-376 537.36,-382 531.36,-388 525.36,-388"></path> <text text-anchor="start" x="176.82" y="-367" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="20.00">Approach 1:</text> <text text-anchor="start" x="293.5" y="-367" font-family="Helvetica,sans-Serif" font-size="20.00"> Model Conditional Hazard</text> <text text-anchor="start" x="306.78" y="-347" font-family="Helvetica,sans-Serif" font-style="italic" font-size="20.00">λ(y|X) = …</text> </g> <!-- Challenge&#45;&gt;Hazard_Model --> <g id="edge3" class="edge">
<title>
Challenge-&gt;Hazard_Model
</title>
<path fill="none" stroke="#333333" d="M353,-459.94C353,-459.94 353,-398.34 353,-398.34"></path> <polygon fill="#333333" stroke="#333333" points="356.5,-398.34 353,-388.34 349.5,-398.34 356.5,-398.34"></polygon> </g> <!-- Solution --> <g id="node2" class="node">
<title>
Solution
</title>
<path fill="#ffffff" stroke="#b3d9ff" d="M1141.81,-496C1141.81,-496 688.19,-496 688.19,-496 682.19,-496 676.19,-490 676.19,-484 676.19,-484 676.19,-472 676.19,-472 676.19,-466 682.19,-460 688.19,-460 688.19,-460 1141.81,-460 1141.81,-460 1147.81,-460 1153.81,-466 1153.81,-472 1153.81,-472 1153.81,-484 1153.81,-484 1153.81,-490 1147.81,-496 1141.81,-496"></path> <text text-anchor="middle" x="915" y="-472" font-family="Helvetica,sans-Serif" font-size="20.00">Compute jackknife pseudo-observations from ECDF</text> </g> <!-- CDF_Model --> <g id="node3" class="node">
<title>
CDF_Model
</title>
<path fill="#ffffff" stroke="#b3d9ff" d="M1050.72,-388C1050.72,-388 657.28,-388 657.28,-388 651.28,-388 645.28,-382 645.28,-376 645.28,-376 645.28,-352 645.28,-352 645.28,-346 651.28,-340 657.28,-340 657.28,-340 1050.72,-340 1050.72,-340 1056.72,-340 1062.72,-346 1062.72,-352 1062.72,-352 1062.72,-376 1062.72,-376 1062.72,-382 1056.72,-388 1050.72,-388"></path> <text text-anchor="start" x="653.39" y="-367" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="20.00">Approach 2:</text> <text text-anchor="start" x="770.07" y="-367" font-family="Helvetica,sans-Serif" font-size="20.00"> Model Conditional CDF Directly</text> <text text-anchor="start" x="796.11" y="-347" font-family="Helvetica,sans-Serif" font-style="italic" font-size="20.00">g[F(y|X)] = …</text> </g> <!-- Solution&#45;&gt;CDF_Model --> <g id="edge4" class="edge">
<title>
Solution-&gt;CDF_Model
</title>
<path fill="none" stroke="#333333" d="M869.48,-459.94C869.48,-459.94 869.48,-398.34 869.48,-398.34"></path> <polygon fill="#333333" stroke="#333333" points="872.98,-398.34 869.48,-388.34 865.98,-398.34 872.98,-398.34"></polygon> </g> <!-- Summary --> <g id="node6" class="node">
<title>
Summary
</title>
<path fill="#ffffff" stroke="#b3d9ff" d="M740.57,-160C740.57,-160 379.43,-160 379.43,-160 373.43,-160 367.43,-154 367.43,-148 367.43,-148 367.43,-136 367.43,-136 367.43,-130 373.43,-124 379.43,-124 379.43,-124 740.57,-124 740.57,-124 746.57,-124 752.57,-130 752.57,-136 752.57,-136 752.57,-148 752.57,-148 752.57,-154 746.57,-160 740.57,-160"></path> <text text-anchor="middle" x="560" y="-136" font-family="Helvetica,sans-Serif" font-size="20.00">Summarize the full conditional distribution</text> </g> <!-- CDF_Model&#45;&gt;Summary --> <g id="edge6" class="edge">
<title>
CDF_Model-&gt;Summary
</title>
<path fill="none" stroke="#333333" d="M698.96,-339.82C698.96,-339.82 698.96,-170.1 698.96,-170.1"></path> <polygon fill="#333333" stroke="#333333" points="702.46,-170.1 698.96,-160.1 695.46,-170.1 702.46,-170.1"></polygon> </g> <!-- Derive_PDF --> <g id="node5" class="node">
<title>
Derive_PDF
</title>
<path fill="#ffffff" stroke="#b3d9ff" d="M549.04,-268C549.04,-268 242.96,-268 242.96,-268 236.96,-268 230.96,-262 230.96,-256 230.96,-256 230.96,-244 230.96,-244 230.96,-238 236.96,-232 242.96,-232 242.96,-232 549.04,-232 549.04,-232 555.04,-232 561.04,-238 561.04,-244 561.04,-244 561.04,-256 561.04,-256 561.04,-262 555.04,-268 549.04,-268"></path> <text text-anchor="middle" x="396" y="-244" font-family="Helvetica,sans-Serif" font-size="20.00">Derive PDF from hazard estimates*</text> </g> <!-- Hazard_Model&#45;&gt;Derive_PDF --> <g id="edge1" class="edge">
<title>
Hazard_Model-&gt;Derive_PDF
</title>
<path fill="none" stroke="#333333" d="M383.96,-339.82C383.96,-339.82 383.96,-278.16 383.96,-278.16"></path> <polygon fill="#333333" stroke="#333333" points="387.46,-278.16 383.96,-268.16 380.46,-278.16 387.46,-278.16"></polygon> </g> <!-- Derive_PDF&#45;&gt;Summary --> <g id="edge5" class="edge">
<title>
Derive_PDF-&gt;Summary
</title>
<path fill="none" stroke="#333333" d="M464.37,-231.68C464.37,-231.68 464.37,-170.05 464.37,-170.05"></path> <polygon fill="#333333" stroke="#333333" points="467.87,-170.05 464.37,-160.05 460.87,-170.05 467.87,-170.05"></polygon> </g> <!-- HDR --> <g id="node7" class="node">
<title>
HDR
</title>
<path fill="#ffffff" stroke="#b3d9ff" stroke-width="2" d="M699.18,-52C699.18,-52 420.82,-52 420.82,-52 414.82,-52 408.82,-46 408.82,-40 408.82,-40 408.82,-28 408.82,-28 408.82,-22 414.82,-16 420.82,-16 420.82,-16 699.18,-16 699.18,-16 705.18,-16 711.18,-22 711.18,-28 711.18,-28 711.18,-40 711.18,-40 711.18,-46 705.18,-52 699.18,-52"></path> <text text-anchor="start" x="416.66" y="-29" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="20.00">Highest Density Region (HDR)</text> </g> <!-- Summary&#45;&gt;HDR --> </g>
</svg>
</div>
</div>
</div>
</div>
</section>
<section id="supplementary-joint-probability-density-with-two-stage-model" class="slide level2 smaller">
<h2>Supplementary: Joint probability density with two stage model</h2>
<p>To model the joint probability density function we use the <strong>chain rule of probability</strong>.</p>
<p>Suppose <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> are the outcome variables (like glucose and blood pressure) and we want to obtain estimates of <span class="math inline">\(f(Y_1, Y_2|X)\)</span>. We will use the relation: <span class="math inline">\(f(Y_1, Y_2|X) = f(Y_1|Y_2,X) \times f(Y_2|X)\)</span>.</p>
<p>We fit separate models for <span class="math inline">\(f(Y_2|X)\)</span> and for <span class="math inline">\(f(Y_1|Y_2, X)\)</span>.</p>
<p>Adopting the flexible PWE model on the hazard, the first model is <span class="math display">\[\log[h(y_2|X)] = \beta X + \sum_{k=1}^{K} (\gamma_k + \delta_k X) B_k(y_2)\]</span> and the second model is <span class="math display">\[\log[h(y_1|\textbf{X})] = \textbf{X}\beta  + \sum_{k=1}^{K} (\gamma_k + \textbf{X}\delta_k ) B_k(y_1)\]</span> where <span class="math inline">\(\textbf{X}\)</span> is a matrix containing values of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y_2\)</span>.</p>
</section>
<section id="supplementary-interrelationships-between-fy-sy-hy-and-hy" class="slide level2 smaller">
<h2>Supplementary: Interrelationships between <span class="math inline">\(f(y)\)</span>, <span class="math inline">\(S(y)\)</span>, <span class="math inline">\(h(y)\)</span>, and <span class="math inline">\(H(y)\)</span></h2>
<p>These functions provide alternative but mathematically equivalent characterizations of a distribution. Their interconnections are crucial for theoretical development and practical application.</p>
<p>The hazard function is fundamentally the ratio:</p>
<p><span class="math display">\[\scriptsize h(y) = \frac{f(y)}{S(y)}\]</span></p>
<p><span class="math display">\[\scriptsize f(y) = h(y)S(y)\]</span></p>
<p>The survival function derives from the cumulative hazard:</p>
<p><span class="math display">\[\scriptsize S(y) = \exp[-H(y)] = \exp\left[-\int_{0}^{y} h(u)du\right]\]</span></p>
<p>This demonstrates that modeling <span class="math inline">\(h(y)\)</span> (or <span class="math inline">\(h(y \mid \mathbf{X})\)</span>) or the <span class="math inline">\(F(y)\)</span> fully determines the event time distribution. The hazard function can also be expressed as:</p>
<p><span class="math display">\[\scriptsize h(y) = -\frac{d}{dt} \log S(y)\]</span></p>
<p>Correspondingly:</p>
<p><span class="math display">\[H(t) = -\log S(t)\]</span></p>
</section>
<section id="supplementary-pseudo-observations" class="slide level2 smaller">
<h2>Supplementary: pseudo-observations</h2>
<p>Pseudo-observations offer a powerful method for analyzing data using standard regression models. The technique, derived from jackknife resampling, creates a complete set of outcome variables, one for each subject, that can be used in frameworks like Generalized Linear Models (GLMs).</p>
<p><strong>Obtaining pseudo-observations</strong></p>
<p>First, an overall estimate of the quantity of interest, <span class="math inline">\(\theta(y)\)</span> (e.g., the empirical cumulative distribution function at the value <span class="math inline">\(y\)</span>), is calculated using the full dataset of n subjects.</p>
<p>Next, for each subject i, a “leave-one-out” estimate, <span class="math inline">\(\widehat{\theta}_{-i}\)</span> is calculated from the dataset of the remaining <span class="math inline">\(n-1\)</span> subjects.</p>
<p>The pseudo-observation for subject i is then computed as:</p>
<p><span class="math inline">\(\widehat{\theta_i}(y) = n \cdot \widehat{\theta}(y) - (n-1)\cdot \widehat{\theta}(y)_{-i}\)</span></p>
<p>The key property of a pseudo-observation <span class="math inline">\(\widehat{\theta}_i(y)\)</span>is that its conditional expectation approximates the true conditional event probability: <span class="math inline">\(E[\widehat{\theta}_i(y)| X_i] = P(Y \le y|X_i)\)</span>.</p>
<p>In the script, a function calculates these pseudo-observations across a grid of <span class="math inline">\(y\)</span> values and reshapes the data into a long format, with one row per subject for each value.</p>
<p><strong>Flexible Modeling with Restricted Cubic Splines</strong></p>
<p>To flexibly model the shape of the baseline CDF, we use restricted cubic splines (RCS), generated via the rms::rcs() function from Frank Harrell’s rms package.</p>
<p>Similar to the PWE analysis, the spline’s complexity is not fixed but optimized automatically. The script iterates through models with different numbers of knots (e.g., from 3 to 10) and selects the one that minimizes the Bayesian Information Criterion (BIC), effectively balancing model fit and parsimony.</p>
</section>
<section id="supplementary-the-piecewise-exponential-model" class="slide level2 smaller">
<h2>Supplementary: The Piecewise Exponential Model</h2>
<p>The Piecewise Exponential (PWE) model approximates a hazard function by dividing a variable, Y, into contiguous intervals defined by <span class="math inline">\(J\)</span> cutpoints <span class="math inline">\(0 = c_1 &lt; c_2 &lt; ... &lt; c_j = \infty\)</span>. In the basic PWE model, the hazard rate, <span class="math inline">\(\lambda_j\)</span>, is constant within each interval, creating a step-function. By using more cutpoints where the hazard changes rapidly and fewer where it is stable, this method can accurately approximate any smooth hazard function.</p>
<p>We enhance the model by using natural splines to model the log-baseline hazard, which transforms the step-function into a smooth, continuous curve for greater flexibility.</p>
<p><strong>Implementation via Poisson Regression</strong></p>
<p>The model is fitted by leveraging the mathematical equivalence between the PWE likelihood and a Poisson regression likelihood. This requires transforming the dataset from a standard one-row-per-subject format to a “long” format. Each subject’s variable <span class="math inline">\(Y\)</span> is split across the intervals they do not realize the value, creating a new row for each person-interval. Each new row includes:</p>
<p>An indicator (0,1), set to 1 for the interval where the value <span class="math inline">\(y\)</span> is realized and 0 for all others.</p>
<p>The difference between the start of the interval and the specific <span class="math inline">\(y\)</span> value contributed by the subject within that specific interval.</p>
<p>The subject’s original covariates, duplicated across all their rows.</p>
<p><strong>Automated Flexibility Selection</strong></p>
<p>Instead of using a fixed number of knots, the model’s flexibility is optimized automatically. The script fits a series of models by iterating through a range of degrees of freedom (df) from 2 to 10, which controls the complexity of the spline.</p>
<p>The basis for the curve is a natural cubic spline—a piecewise cubic polynomial constrained to be linear in the tails (before the first knot and after the last). This ensures more stable and realistic behavior when extrapolating.</p>
<p>For each tested df, we compute the Bayesian Information Criterion (BIC). The final model selected is the one with the optimal df that minimizes the BIC, effectively balancing goodness-of-fit with model parsimony.</p>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>

<img src="SM.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Salerno, Joint Conference of the Italian and Eastern Mediterranean Regions of the International Biometric Society</p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-andersen2003" class="csl-entry" role="listitem">
Andersen, P. K. 2003. <span>“Generalised Linear Models for Correlated Pseudo-Observations, with Applications to Multi-State Models.”</span> <em>Biometrika</em> 90 (1): 15–27. <a href="https://doi.org/10.1093/biomet/90.1.15">https://doi.org/10.1093/biomet/90.1.15</a>.
</div>
<div id="ref-beckstead2010" class="csl-entry" role="listitem">
Beckstead, Jason W., and Theresa M. Beckie. 2010. <span>“How Much Information Can Metabolic Syndrome Provide?”</span> <em>Medical Decision Making</em> 31 (1): 79–92. <a href="https://doi.org/10.1177/0272989x10373401">https://doi.org/10.1177/0272989x10373401</a>.
</div>
<div id="ref-hyndman1996" class="csl-entry" role="listitem">
Hyndman, Rob J. 1996. <span>“Computing and Graphing Highest Density Regions.”</span> <em>The American Statistician</em> 50 (2): 120–26. <a href="https://doi.org/10.1080/00031305.1996.10474359">https://doi.org/10.1080/00031305.1996.10474359</a>.
</div>
<div id="ref-keen1971" class="csl-entry" role="listitem">
Keen, H., and R. J. Jarett. 1971. <span>“DIABETES MELLITUS IN PIMA INDIANS.”</span> <em>The Lancet</em> 298 (7720): 379–80. <a href="https://doi.org/10.1016/s0140-6736(71)90098-5">https://doi.org/10.1016/s0140-6736(71)90098-5</a>.
</div>
<div id="ref-laird1981" class="csl-entry" role="listitem">
Laird, Nan, and Donald Olivier. 1981. <span>“Covariance Analysis of Censored Survival Data Using Log-Linear Analysis Techniques.”</span> <em>Journal of the American Statistical Association</em> 76 (374): 231–40. <a href="https://doi.org/10.1080/01621459.1981.10477634">https://doi.org/10.1080/01621459.1981.10477634</a>.
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Presentation Salerno_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Presentation Salerno_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Presentation Salerno_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Presentation Salerno_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Presentation Salerno_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Presentation Salerno_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Presentation Salerno_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Presentation Salerno_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Presentation Salerno_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Presentation Salerno_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>